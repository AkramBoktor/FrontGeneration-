<div ng2FileDrop (onFileDrop)="fileDrop($event)" [ngClass]="{ 'nv-file-over': hasBaseDropZoneOver }"
    (fileOver)="fileOverBase($event)" [uploader]="uploader" class="well my-drop-zone">
    Drop file here
</div>

<div class="row">
    <div style="margin-bottom: 40px" *ngIf="dataSource?.data?.length> 0">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef style="min-width: 100px;">
                    الأسم
                </th>
                <td mat-cell *matCellDef="let item">
                    <strong>{{ item?.name }}</strong>
                </td>
            </ng-container>

            <ng-container matColumnDef="size">
                <th mat-header-cell *matHeaderCellDef style="text-align: center;">
                    الحجم
                </th>
                <td mat-cell *matCellDef="let item">
                    {{ item?.size / 1024 | number: "1.0-0" }} KB
                </td>
            </ng-container>

            <ng-container matColumnDef="buttons">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let item">
                    <button *ngIf="!item.id && id && !disabled" color="accent" (click)="uploadfile([item])"
                        mat-mini-fab>
                        <mat-icon>cloud_upload</mat-icon>
                    </button>
                    <button *ngIf="item.id && !disabled" color="primary" (click)="downloadfile(item.id, item.name)"
                        mat-mini-fab>
                        <mat-icon>cloud_download</mat-icon>
                    </button>
                    <button *ngIf="!item.id && !disabled" (click)="onPendingDelete([item])" color="warn" mat-mini-fab>
                        <mat-icon>close</mat-icon>
                    </button>
                    <button *ngIf="item.id" (click)="onPostDelete(item)" color="warn" mat-mini-fab>
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['name', 'size', 'buttons']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['name', 'size', 'buttons']"></tr>
        </table>
        <div *ngIf="id && !disabled">
            <div>
                <mat-progress-bar *ngIf="progressBar" mode="determinate" [value]="progress">
                </mat-progress-bar>
            </div>
            <button color="accent" (click)="uploadfile(dataSourcePending)" [disabled]="!dataSourcePending.length"
                mat-raised-button>
                <mat-icon>cloud_upload</mat-icon> رفع جميع الملفات
            </button>
            <button color="warn" (click)="onPendingDelete(dataSource?.data)" [disabled]="!dataSourcePending.length"
                mat-raised-button>
                <mat-icon>close</mat-icon> الغاء الكل
            </button>
        </div>
    </div>
</div>